<!doctype html>
<html lang="fr">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Éditeur | Synaptech Builder</title>

  <!-- GrapesJS (éditeur drag & drop) -->
  <link rel="stylesheet" href="https://unpkg.com/grapesjs/dist/css/grapes.min.css">
  <script src="https://unpkg.com/grapesjs"></script>

  <style>
    html,body{height:100%;margin:0;font-family:system-ui,-apple-system,Segoe UI,Roboto,Arial}
    #topbar{
      height:56px;display:flex;align-items:center;justify-content:space-between;
      padding:0 14px;border-bottom:1px solid #e6e9ef;background:#fff
    }
    .btn{padding:10px 14px;border-radius:12px;border:1px solid #e6e9ef;background:#fff;font-weight:800;cursor:pointer}
    .btn.primary{background:#116dff;color:#fff;border:none}
    #gjs{height:calc(100% - 56px)}
  </style>
</head>
<body>
  <div id="topbar">
    <div style="font-weight:950">Synaptech Builder — Éditeur</div>
    <div style="display:flex;gap:10px;flex-wrap:wrap">
      <button class="btn" onclick="loadTemplateFromHash()">Charger template</button>
      <button class="btn" onclick="downloadHtml()">Exporter HTML</button>
      <button class="btn primary" onclick="openWhatsApp()">Support WhatsApp</button>
    </div>
  </div>

  <div id="gjs"></div>

  <script>
    const editor = grapesjs.init({
      container: '#gjs',
      fromElement: false,
      storageManager: { type: 'local' }, // garde ton travail dans le navigateur
      height: '100%',
      width: 'auto',
    });

    // Blocks simples (pour début)
    editor.BlockManager.add('hero', {
      label: 'Hero',
      content: `
        <section style="padding:70px 24px; background:#f6f8ff; font-family:system-ui">
          <div style="max-width:1000px;margin:auto">
            <h1 style="margin:0;font-size:48px;letter-spacing:-1px">Ton site officiel</h1>
            <p style="color:#5b6475;font-weight:650;max-width:70ch">
              WhatsApp + Maps + photos + prix. Simple et clair.
            </p>
            <div style="margin-top:16px;display:flex;gap:10px;flex-wrap:wrap">
              <a href="https://wa.me/21622961115" style="background:#116dff;color:#fff;padding:12px 16px;border-radius:14px;text-decoration:none;font-weight:800">WhatsApp</a>
              <a href="#" style="border:1px solid #e6e9ef;background:#fff;padding:12px 16px;border-radius:14px;text-decoration:none;font-weight:800">Google Maps</a>
            </div>
          </div>
        </section>`
    });

    editor.BlockManager.add('section', {
      label: 'Section',
      content: `
        <section style="padding:46px 24px;font-family:system-ui">
          <div style="max-width:1000px;margin:auto">
            <h2 style="margin:0 0 10px;letter-spacing:-.4px">Titre de section</h2>
            <p style="color:#5b6475;font-weight:650">Texte simple ici.</p>
          </div>
        </section>`
    });

    editor.BlockManager.add('cards', {
      label: 'Cartes',
      content: `
        <section style="padding:46px 24px;font-family:system-ui">
          <div style="max-width:1000px;margin:auto;display:grid;grid-template-columns:repeat(3,1fr);gap:14px">
            <div style="border:1px solid #e6e9ef;border-radius:16px;padding:18px;background:#fff">
              <b>WhatsApp</b><div style="color:#5b6475;font-weight:650">Contact direct</div>
            </div>
            <div style="border:1px solid #e6e9ef;border-radius:16px;padding:18px;background:#fff">
              <b>Maps</b><div style="color:#5b6475;font-weight:650">Adresse claire</div>
            </div>
            <div style="border:1px solid #e6e9ef;border-radius:16px;padding:18px;background:#fff">
              <b>Photos</b><div style="color:#5b6475;font-weight:650">Galerie</div>
            </div>
          </div>
        </section>`
    });

    const templates = {
      barber: `
        <div>
          <h1>Barber Pro</h1>
          <p>Coupe + barbe • Réservation WhatsApp</p>
        </div>`,
      restaurant: `
        <div>
          <h1>Restaurant</h1>
          <p>Menu + Maps + Réservation</p>
        </div>`,
      car: `
        <div>
          <h1>Location voiture</h1>
          <p>Réserver par WhatsApp</p>
        </div>`,
      artisan: `
        <div>
          <h1>Artisan</h1>
          <p>Services + Devis WhatsApp</p>
        </div>`
    };

    function loadTemplateFromHash(){
      const hash = new URLSearchParams(location.hash.replace('#','?'));
      const tpl = hash.get('tpl') || 'barber';
      editor.setComponents(`
        <section style="padding:70px 24px;background:#f6f8ff;font-family:system-ui">
          <div style="max-width:1000px;margin:auto">
            ${templates[tpl] || templates.barber}
            <div style="margin-top:16px;display:flex;gap:10px;flex-wrap:wrap">
              <a href="https://wa.me/21622961115" style="background:#116dff;color:#fff;padding:12px 16px;border-radius:14px;text-decoration:none;font-weight:800">WhatsApp</a>
              <a href="#" style="border:1px solid #e6e9ef;background:#fff;padding:12px 16px;border-radius:14px;text-decoration:none;font-weight:800">Google Maps</a>
            </div>
          </div>
        </section>
      `);
    }

    function downloadHtml(){
      const html = editor.getHtml();
      const css = editor.getCss();
      const full = `<!doctype html><html><head><meta charset="utf-8"><meta name="viewport" content="width=device-width, initial-scale=1"><title>Mon site</title><style>${css}</style></head><body>${html}</body></html>`;
      const blob = new Blob([full], { type: 'text/html' });
      const a = document.createElement('a');
      a.href = URL.createObjectURL(blob);
      a.download = 'site.html';
      a.click();
      URL.revokeObjectURL(a.href);
    }

    function openWhatsApp(){
      window.open("https://wa.me/21622961115?text=Salut%20Synaptech%2C%20j%27ai%20besoin%20d%27aide%20sur%20Builder", "_blank");
    }

    // Auto-load template if provided
    loadTemplateFromHash();
  </script>
</body>
</html>
